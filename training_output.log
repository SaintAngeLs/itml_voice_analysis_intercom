Loaded 2402 images: 721 allowed, 1681 disallowed.
Epoch 1/50
[1m 1/42[0m [37m━━━━━━━━━━━━━━━━━━━━[0m [1m2:47[0m 4s/step - accuracy: 0.6250 - loss: 1.0472[1m 2/42[0m [37m━━━━━━━━━━━━━━━━━━━━[0m [1m24s[0m 614ms/step - accuracy: 0.5859 - loss: 1.0830[1m 3/42[0m [32m━[0m[37m━━━━━━━━━━━━━━━━━━━[0m [1m24s[0m 640ms/step - accuracy: 0.5712 - loss: 1.1035[1m 4/42[0m [32m━[0m[37m━━━━━━━━━━━━━━━━━━━[0m [1m24s[0m 636ms/step - accuracy: 0.5690 - loss: 1.1058[1m 5/42[0m [32m━━[0m[37m━━━━━━━━━━━━━━━━━━[0m [1m23s[0m 639ms/step - accuracy: 0.5702 - loss: 1.1022[1m 6/42[0m [32m━━[0m[37m━━━━━━━━━━━━━━━━━━[0m [1m22s[0m 629ms/step - accuracy: 0.5698 - loss: 1.1000[1m 7/42[0m [32m━━━[0m[37m━━━━━━━━━━━━━━━━━[0m [1m21s[0m 626ms/step - accuracy: 0.5681 - loss: 1.0997[1m 8/42[0m [32m━━━[0m[37m━━━━━━━━━━━━━━━━━[0m [1m21s[0m 622ms/step - accuracy: 0.5659 - loss: 1.0986[1m 9/42[0m [32m━━━━[0m[37m━━━━━━━━━━━━━━━━[0m [1m20s[0m 619ms/step - accuracy: 0.5648 - loss: 1.0972[1m10/42[0m [32m━━━━[0m[37m━━━━━━━━━━━━━━━━[0m [1m19s[0m 621ms/step - accuracy: 0.5639 - loss: 1.0957[1m11/42[0m [32m━━━━━[0m[37m━━━━━━━━━━━━━━━[0m [1m19s[0m 617ms/step - accuracy: 0.5635 - loss: 1.0948[1m12/42[0m [32m━━━━━[0m[37m━━━━━━━━━━━━━━━[0m [1m18s[0m 614ms/step - accuracy: 0.5626 - loss: 1.0948[1m13/42[0m [32m━━━━━━[0m[37m━━━━━━━━━━━━━━[0m [1m17s[0m 613ms/step - accuracy: 0.5620 - loss: 1.0942[1m14/42[0m [32m━━━━━━[0m[37m━━━━━━━━━━━━━━[0m [1m17s[0m 611ms/step - accuracy: 0.5611 - loss: 1.0943[1m15/42[0m [32m━━━━━━━[0m[37m━━━━━━━━━━━━━[0m [1m16s[0m 609ms/step - accuracy: 0.5601 - loss: 1.0948[1m16/42[0m [32m━━━━━━━[0m[37m━━━━━━━━━━━━━[0m [1m16s[0m 629ms/step - accuracy: 0.5591 - loss: 1.0949[1m17/42[0m [32m━━━━━━━━[0m[37m━━━━━━━━━━━━[0m [1m15s[0m 633ms/step - accuracy: 0.5583 - loss: 1.0950[1m18/42[0m [32m━━━━━━━━[0m[37m━━━━━━━━━━━━[0m [1m15s[0m 632ms/step - accuracy: 0.5574 - loss: 1.0950[1m19/42[0m [32m━━━━━━━━━[0m[37m━━━━━━━━━━━[0m [1m14s[0m 632ms/step - accuracy: 0.5567 - loss: 1.0952[1m20/42[0m [32m━━━━━━━━━[0m[37m━━━━━━━━━━━[0m [1m13s[0m 631ms/step - accuracy: 0.5563 - loss: 1.0952[1m21/42[0m [32m━━━━━━━━━━[0m[37m━━━━━━━━━━[0m [1m13s[0m 632ms/step - accuracy: 0.5558 - loss: 1.0952[1m22/42[0m [32m━━━━━━━━━━[0m[37m━━━━━━━━━━[0m [1m12s[0m 634ms/step - accuracy: 0.5555 - loss: 1.0952[1m23/42[0m [32m━━━━━━━━━━[0m[37m━━━━━━━━━━[0m [1m12s[0m 634ms/step - accuracy: 0.5550 - loss: 1.0951[1m24/42[0m [32m━━━━━━━━━━━[0m[37m━━━━━━━━━[0m [1m11s[0m 652ms/step - accuracy: 0.5547 - loss: 1.0950[1m25/42[0m [32m━━━━━━━━━━━[0m[37m━━━━━━━━━[0m [1m11s[0m 658ms/step - accuracy: 0.5545 - loss: 1.0948[1m26/42[0m [32m━━━━━━━━━━━━[0m[37m━━━━━━━━[0m [1m10s[0m 660ms/step - accuracy: 0.5543 - loss: 1.0948[1m27/42[0m [32m━━━━━━━━━━━━[0m[37m━━━━━━━━[0m [1m9s[0m 658ms/step - accuracy: 0.5541 - loss: 1.0948 [1m28/42[0m [32m━━━━━━━━━━━━━[0m[37m━━━━━━━[0m [1m9s[0m 656ms/step - accuracy: 0.5538 - loss: 1.0949[1m29/42[0m [32m━━━━━━━━━━━━━[0m[37m━━━━━━━[0m [1m8s[0m 655ms/step - accuracy: 0.5536 - loss: 1.0950[1m30/42[0m [32m━━━━━━━━━━━━━━[0m[37m━━━━━━[0m [1m7s[0m 653ms/step - accuracy: 0.5536 - loss: 1.0949[1m31/42[0m [32m━━━━━━━━━━━━━━[0m[37m━━━━━━[0m [1m7s[0m 652ms/step - accuracy: 0.5536 - loss: 1.0949[1m32/42[0m [32m━━━━━━━━━━━━━━━[0m[37m━━━━━[0m [1m6s[0m 650ms/step - accuracy: 0.5535 - loss: 1.0950[1m33/42[0m [32m━━━━━━━━━━━━━━━[0m[37m━━━━━[0m [1m5s[0m 648ms/step - accuracy: 0.5533 - loss: 1.0951[1m34/42[0m [32m━━━━━━━━━━━━━━━━[0m[37m━━━━[0m [1m5s[0m 647ms/step - accuracy: 0.5531 - loss: 1.0951[1m35/42[0m [32m━━━━━━━━━━━━━━━━[0m[37m━━━━[0m [1m4s[0m 646ms/step - accuracy: 0.5529 - loss: 1.0952[1m36/42[0m [32m━━━━━━━━━━━━━━━━━[0m[37m━━━[0m [1m3s[0m 646ms/step - accuracy: 0.5527 - loss: 1.0952[1m37/42[0m [32m━━━━━━━━━━━━━━━━━[0m[37m━━━[0m [1m3s[0m 644ms/step - accuracy: 0.5525 - loss: 1.0952[1m38/42[0m [32m━━━━━━━━━━━━━━━━━━[0m[37m━━[0m [1m2s[0m 643ms/step - accuracy: 0.5524 - loss: 1.0952[1m39/42[0m [32m━━━━━━━━━━━━━━━━━━[0m[37m━━[0m [1m1s[0m 642ms/step - accuracy: 0.5522 - loss: 1.0951[1m40/42[0m [32m━━━━━━━━━━━━━━━━━━━[0m[37m━[0m [1m1s[0m 641ms/step - accuracy: 0.5521 - loss: 1.0950[1m41/42[0m [32m━━━━━━━━━━━━━━━━━━━[0m[37m━[0m [1m0s[0m 640ms/step - accuracy: 0.5519 - loss: 1.0950[1m42/42[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 639ms/step - accuracy: 0.5517 - loss: 1.0949[1m42/42[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m35s[0m 750ms/step - accuracy: 0.5515 - loss: 1.0949 - val_accuracy: 0.6997 - val_loss: 0.9568 - learning_rate: 1.0000e-04
Epoch 2/50
Traceback (most recent call last):
  File "/home/kaliuser/Documents/portfolio/commercial_apps/itml_cs_1/itml_voice_analysis_intercom/./src/train.py", line 185, in <module>
    main(use_augmentation=True)
  File "/home/kaliuser/Documents/portfolio/commercial_apps/itml_cs_1/itml_voice_analysis_intercom/./src/train.py", line 170, in main
    model.fit(
  File "/home/kaliuser/Documents/portfolio/commercial_apps/itml_cs/venv/lib/python3.12/site-packages/keras/src/utils/traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/home/kaliuser/Documents/portfolio/commercial_apps/itml_cs/venv/lib/python3.12/site-packages/tensorflow/python/eager/execute.py", line 53, in quick_execute
    tensors = pywrap_tfe.TFE_Py_Execute(ctx._handle, device_name, op_name,
  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tensorflow.python.framework.errors_impl.UnknownError: Graph execution error:

Detected at node PyFunc defined at (most recent call last):
<stack traces unavailable>
RuntimeError: generator raised StopIteration
Traceback (most recent call last):

  File "/home/kaliuser/Documents/portfolio/commercial_apps/itml_cs_1/itml_voice_analysis_intercom/./src/train.py", line 113, in custom_data_generator
    sample_weight_batch = np.array([next(sample_weights_gen) for _ in range(len(y_batch))])
                                    ^^^^^^^^^^^^^^^^^^^^^^^^

StopIteration


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/home/kaliuser/Documents/portfolio/commercial_apps/itml_cs/venv/lib/python3.12/site-packages/tensorflow/python/ops/script_ops.py", line 270, in __call__
    ret = func(*args)
          ^^^^^^^^^^^

  File "/home/kaliuser/Documents/portfolio/commercial_apps/itml_cs/venv/lib/python3.12/site-packages/tensorflow/python/autograph/impl/api.py", line 643, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^

  File "/home/kaliuser/Documents/portfolio/commercial_apps/itml_cs/venv/lib/python3.12/site-packages/tensorflow/python/data/ops/from_generator_op.py", line 198, in generator_py_func
    values = next(generator_state.get_iterator(iterator_id))
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/home/kaliuser/Documents/portfolio/commercial_apps/itml_cs/venv/lib/python3.12/site-packages/keras/src/trainers/data_adapters/generator_data_adapter.py", line 52, in get_tf_iterator
    for batch in self.generator:
                 ^^^^^^^^^^^^^^

RuntimeError: generator raised StopIteration


	 [[{{node PyFunc}}]]
	 [[IteratorGetNext]] [Op:__inference_one_step_on_iterator_6325]
